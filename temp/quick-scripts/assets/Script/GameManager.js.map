{"version":3,"sources":["GameManager.js"],"names":["cc","Class","extends","Component","properties","onLoad","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","onDestroy","off","start","gold","com_customerManager","find","getComponent","com_countDown","com_timeBar","com_scoreBar","com_play","com_settlement","anim_chief","Animation","anim_register","setGameSpeed","initCunstomer","startCountDown","init","onTimeOver","setNumber","cooking","speed","gameSpeed","setSpeed","log","moveUp","result","satisfyCustomer","play","rollNumber","playAction","update","dt","event","keyCode","macro","KEY","a","s","d","c"],"mappings":"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","file":"GameManager.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["\r\ncc.Class({\r\n\textends: cc.Component,\r\n\r\n\tproperties: {\r\n\t},\r\n\r\n\tonLoad() {\r\n\t\tcc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n\t},\r\n\tonDestroy() {\r\n\t\tcc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n\t},\r\n\r\n\tstart() {\r\n\r\n\t\tthis.gold = 0;\r\n\t\t//\r\n\t\tthis.com_customerManager = cc.find(\"Canvas/Customer\").getComponent(\"Game_CustomerManager\");\r\n\t\tthis.com_countDown = cc.find(\"Canvas/UI/ui_countDown\").getComponent(\"UI_CountDown\");\r\n\t\tthis.com_timeBar = cc.find(\"Canvas/UI/ui_timeBar\").getComponent(\"UI_Timer\");\r\n\t\tthis.com_scoreBar = cc.find(\"Canvas/UI/ui_scoreBar\").getComponent(\"UI_Number\");\r\n\t\tthis.com_play = cc.find(\"Canvas/UI/ui_play\").getComponent(\"Game_Play\");\r\n\t\tthis.com_settlement = cc.find(\"Canvas/UI/ui_settlement\").getComponent(\"UI_Settlement\");\r\n\t\t//\r\n\t\tthis.anim_chief = cc.find(\"Canvas/ch_chief\").getComponent(cc.Animation);\r\n\t\tthis.anim_register = cc.find(\"Canvas/add_register\").getComponent(cc.Animation);\r\n\r\n\t\t// 游戏正常速度\r\n\t\tthis.setGameSpeed(1);\r\n\t\t// 顾客入场\r\n\t\tthis.com_customerManager.initCunstomer(() => { });\r\n\t\t// 3 2 1 go\r\n\t\tthis.com_countDown.startCountDown(() => {\r\n\t\t\t// 走时间\r\n\t\t\tthis.com_timeBar.init(150, this.onTimeOver);\r\n\t\t\t// 初始化金币\r\n\t\t\tthis.com_scoreBar.setNumber(this.gold);\r\n\t\t\t// 开始\r\n\t\t\tthis.cooking();\r\n\t\t});\r\n\t},\r\n\r\n\t// 游戏开始\r\n\t//startGame() { },\r\n\r\n\t// 游戏速度\r\n\tsetGameSpeed(speed) {\r\n\t\tthis.gameSpeed = speed;\r\n\t\tthis.com_customerManager.setSpeed(speed);\r\n\t},\r\n\r\n\t// 时间结束\r\n\tonTimeOver() {\r\n\t\tcc.log(\"Time Over!!\");\r\n\t\tthis.setGameSpeed(0);\r\n\t\tthis.com_settlement.init(this.gold, () => { cc.log(\"onContinue......\"); });\r\n\t},\r\n\r\n\t// 队伍前进 result当前交互结果: 0不满意 1普通 2满意\r\n\tmoveUp(result) {\r\n\t\t// 排队\r\n\t\tlet gold = this.com_customerManager.satisfyCustomer(result, () => { this.cooking(); });\r\n\t\tif (gold > 0) {\r\n\t\t\tthis.anim_register.play(); // 收银机动画\r\n\t\t\tthis.gold += gold;\r\n\t\t\tthis.com_scoreBar.rollNumber(this.gold);\r\n\t\t}\r\n\t},\r\n\t// 烧菜互动\r\n\tcooking() {\r\n\t\tif (this.gameSpeed == 0) { return; }\r\n\r\n\t\t// 烧菜\r\n\t\tthis.anim_chief.play(\"anim_chief_cooking\"); // 厨师烧菜动画 loop\r\n\t\t// 互动\r\n\t\tthis.com_play.playAction((result) => {\r\n\t\t\tif (result == 0) {\r\n\t\t\t\tthis.anim_chief.play(\"anim_chief_lost\"); // 厨师失败动画\r\n\t\t\t} else {\r\n\t\t\t\tthis.anim_chief.play(\"anim_chief_win\"); // 厨师胜利动画\r\n\t\t\t}\r\n\t\t\tthis.moveUp(result);\r\n\t\t});\r\n\t},\r\n\r\n\tupdate(dt) { },\r\n\r\n\tonKeyDown(event) {\r\n\t\tswitch (event.keyCode) {\r\n\t\t\tcase cc.macro.KEY.a: {\r\n\t\t\t\tcc.find(\"Canvas/add_register\").getComponent(cc.Animation).play(\"anim_register\"); // 收银机动画\r\n\t\t\t\tlet gold = cc.find(\"Canvas/Customer\").getComponent(\"Game_CustomerManager\").satisfyCustomer(0); // 走一个顾客并计算收益\r\n\t\t\t\tthis.gold += gold;\r\n\t\t\t\tcc.find(\"Canvas/UI/ui_scoreBar\").getComponent(\"UI_Number\").rollNumber(this.gold);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase cc.macro.KEY.s: {\r\n\t\t\t\tcc.find(\"Canvas/add_register\").getComponent(cc.Animation).play(\"anim_register\");\r\n\t\t\t\tlet gold = cc.find(\"Canvas/Customer\").getComponent(\"Game_CustomerManager\").satisfyCustomer(1);\r\n\t\t\t\tthis.gold += gold;\r\n\t\t\t\tcc.find(\"Canvas/UI/ui_scoreBar\").getComponent(\"UI_Number\").rollNumber(this.gold);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase cc.macro.KEY.d: {\r\n\t\t\t\tcc.find(\"Canvas/add_register\").getComponent(cc.Animation).play(\"anim_register\");\r\n\t\t\t\tlet gold = cc.find(\"Canvas/Customer\").getComponent(\"Game_CustomerManager\").satisfyCustomer(2);\r\n\t\t\t\tthis.gold += gold;\r\n\t\t\t\tcc.find(\"Canvas/UI/ui_scoreBar\").getComponent(\"UI_Number\").rollNumber(this.gold);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase cc.macro.KEY.c: {\r\n\t\t\t\t//cc.find(\"Canvas/UI/ui_play/mode_press\").getComponent(\"Game_PlayModePress\").init((score) => { cc.log(\"-.>>>> \" + score) });\r\n\t\t\t\t//cc.find(\"Canvas/UI/ui_play/mode_click\").getComponent(\"Game_PlayModeClick\").init(5, (score) => { cc.log(\"-.>>>> \" + score) });\r\n\t\t\t\t//cc.find(\"Canvas/UI/ui_play/mode_touch\").getComponent(\"Game_PlayModeTouch\").init((score) => { cc.log(\"-.>>>> \" + score) });\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n});\r\n"]}