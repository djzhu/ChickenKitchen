{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\GameManager.js"],"names":["GameManager","cc","Class","extends","Component","statics","instance","properties","onLoad","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","onDestroy","off","start","gold","cheerTime","com_customerManager","find","getComponent","com_countDown","com_timeBar","com_scoreBar","com_play","com_rabbit","com_settlement","anim_chief","Animation","anim_register","node","active","setGameSpeed","initCunstomer","startCountDown","self","init","cooking","setNumber","startCheerTime","log","endCheerTime","speed","gameSpeed","setSpeed","moveUp","result","satisfyCustomer","play","rollNumber","playAction","onGoodService","update","dt","event","keyCode","macro","KEY","a","s","d","c"],"mappings":"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","file":"GameManager.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["\r\nvar GameManager = cc.Class({\r\n\textends: cc.Component,\r\n\r\n\tstatics: {\r\n\t\tinstance: null,\r\n\t},\r\n\tproperties: {\r\n\t},\r\n\r\n\tonLoad() {\r\n\t\tGameManager.instance = this;\r\n\t\tcc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n\t},\r\n\tonDestroy() {\r\n\t\tcc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n\t},\r\n\r\n\tstart() {\r\n\r\n\t\tthis.gold = 0;\r\n\t\t//\r\n\t\tthis.cheerTime = false;\r\n\t\t//\r\n\t\tthis.com_customerManager = cc.find(\"Canvas/Customer\").getComponent(\"Game_CustomerManager\");\r\n\t\tthis.com_countDown = cc.find(\"Canvas/UI/ui_countDown\").getComponent(\"UI_CountDown\");\r\n\t\tthis.com_timeBar = cc.find(\"Canvas/UI/ui_timeBar\").getComponent(\"UI_Timer\");\r\n\t\tthis.com_scoreBar = cc.find(\"Canvas/UI/ui_goldBar\").getComponent(\"UI_Number\");\r\n\t\tthis.com_play = cc.find(\"Canvas/UI/ui_play\").getComponent(\"Game_Play\");\r\n\t\tthis.com_rabbit = cc.find(\"Canvas/UI/ui_rabbit\").getComponent(\"UI_Rabbit\");\r\n\t\tthis.com_settlement = cc.find(\"Canvas/UI/ui_settlement\").getComponent(\"UI_Settlement\");\r\n\t\t//\r\n\t\tthis.anim_chief = cc.find(\"Canvas/ch_chief\").getComponent(cc.Animation);\r\n\t\tthis.anim_register = cc.find(\"Canvas/add_register\").getComponent(cc.Animation);\r\n\r\n\t\t//\r\n\t\tthis.com_settlement.node.active = false;\r\n\r\n\t\t// 游戏正常速度\r\n\t\tthis.setGameSpeed(1);\r\n\t\t// 顾客入场\r\n\t\tthis.com_customerManager.initCunstomer(() => { });\r\n\t\t// 3 2 1 go\r\n\t\tthis.com_countDown.startCountDown(() => {\r\n\t\t\t// 走时间\r\n\t\t\tlet self = this;\r\n\t\t\tthis.com_timeBar.init(150, () => {\r\n\t\t\t\tself.setGameSpeed(0);\r\n\t\t\t\tself.com_settlement.node.active = true;\r\n\t\t\t\tself.com_settlement.init(self.gold, () => {\r\n\t\t\t\t\tthis.com_settlement.node.active = false;\r\n\t\t\t\t\tthis.setGameSpeed(1);\r\n\t\t\t\t\tthis.com_timeBar.init(50, () => {\r\n\t\t\t\t\t\tself.setGameSpeed(0);\r\n\t\t\t\t\t\tself.com_settlement.node.active = true;\r\n\t\t\t\t\t\tself.com_settlement.init(self.gold, null);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.cooking();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\t// 初始化金币\r\n\t\t\tthis.com_scoreBar.setNumber(this.gold);\r\n\t\t\t// 开始\r\n\t\t\tthis.cooking();\r\n\t\t});\r\n\t},\r\n\r\n\t// 游戏开始\r\n\t//startGame() { },\r\n\r\n\t// 触发cheer time\r\n\tstartCheerTime() {\r\n\t\tcc.log(\"start cheer time\");\r\n\t\tthis.cheerTime = true;\r\n\t\tthis.setGameSpeed(4);\r\n\t},\r\n\t// 结束cheer time\r\n\tendCheerTime() {\r\n\t\tcc.log(\"end cheer time\");\r\n\t\tthis.cheerTime = false;\r\n\t\tthis.setGameSpeed(1);\r\n\t},\r\n\r\n\t// 游戏速度\r\n\tsetGameSpeed(speed) {\r\n\t\tthis.gameSpeed = speed;\r\n\t\tthis.com_customerManager.setSpeed(speed);\r\n\t},\r\n\r\n\t// 队伍前进 result当前交互结果: 0不满意 1普通 2满意\r\n\tmoveUp(result) {\r\n\t\t// 排队\r\n\t\tlet gold = this.com_customerManager.satisfyCustomer(result, () => { this.cooking(); });\r\n\t\tif (gold > 0) {\r\n\t\t\tthis.anim_register.play(); // 收银机动画\r\n\t\t\tthis.gold += gold;\r\n\t\t\tthis.com_scoreBar.rollNumber(this.gold);\r\n\t\t}\r\n\t},\r\n\t// 烧菜互动\r\n\tcooking() {\r\n\t\tif (this.gameSpeed == 0) { return; }\r\n\r\n\t\t// 烧菜\r\n\t\tthis.anim_chief.play(\"anim_chief_cooking\"); // 厨师烧菜动画 loop\r\n\t\t// 拉拉兔时间\r\n\t\tif (this.cheerTime) {\r\n\t\t\tthis.anim_chief.play(\"anim_chief_win\"); // 厨师胜利动画\r\n\t\t\tvar result = 2;\r\n\t\t\tthis.moveUp(result);\r\n\t\t} else {\r\n\t\t\t// 互动\r\n\t\t\tthis.com_play.playAction((result) => {\r\n\t\t\t\tif (result == 0) {\r\n\t\t\t\t\tthis.anim_chief.play(\"anim_chief_lost\"); // 厨师失败动画\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.anim_chief.play(\"anim_chief_win\"); // 厨师胜利动画\r\n\t\t\t\t\tif (result == 2) {\r\n\t\t\t\t\t\t// 拉拉兔计数\r\n\t\t\t\t\t\tthis.com_rabbit.onGoodService();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.moveUp(result);\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\r\n\tupdate(dt) { },\r\n\r\n\tonKeyDown(event) {\r\n\t\tswitch (event.keyCode) {\r\n\t\t\tcase cc.macro.KEY.a: {\r\n\t\t\t\tcc.find(\"Canvas/add_register\").getComponent(cc.Animation).play(\"anim_register\"); // 收银机动画\r\n\t\t\t\tlet gold = cc.find(\"Canvas/Customer\").getComponent(\"Game_CustomerManager\").satisfyCustomer(0); // 走一个顾客并计算收益\r\n\t\t\t\tthis.gold += gold;\r\n\t\t\t\tcc.find(\"Canvas/UI/ui_scoreBar\").getComponent(\"UI_Number\").rollNumber(this.gold);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase cc.macro.KEY.s: {\r\n\t\t\t\tcc.find(\"Canvas/add_register\").getComponent(cc.Animation).play(\"anim_register\");\r\n\t\t\t\tlet gold = cc.find(\"Canvas/Customer\").getComponent(\"Game_CustomerManager\").satisfyCustomer(1);\r\n\t\t\t\tthis.gold += gold;\r\n\t\t\t\tcc.find(\"Canvas/UI/ui_scoreBar\").getComponent(\"UI_Number\").rollNumber(this.gold);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase cc.macro.KEY.d: {\r\n\t\t\t\tcc.find(\"Canvas/add_register\").getComponent(cc.Animation).play(\"anim_register\");\r\n\t\t\t\tlet gold = cc.find(\"Canvas/Customer\").getComponent(\"Game_CustomerManager\").satisfyCustomer(2);\r\n\t\t\t\tthis.gold += gold;\r\n\t\t\t\tcc.find(\"Canvas/UI/ui_scoreBar\").getComponent(\"UI_Number\").rollNumber(this.gold);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase cc.macro.KEY.c: {\r\n\t\t\t\t//cc.find(\"Canvas/UI/ui_play/mode_press\").getComponent(\"Game_PlayModePress\").init((score) => { cc.log(\"-.>>>> \" + score) });\r\n\t\t\t\t//cc.find(\"Canvas/UI/ui_play/mode_click\").getComponent(\"Game_PlayModeClick\").init(5, (score) => { cc.log(\"-.>>>> \" + score) });\r\n\t\t\t\t//cc.find(\"Canvas/UI/ui_play/mode_touch\").getComponent(\"Game_PlayModeTouch\").init((score) => { cc.log(\"-.>>>> \" + score) });\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n});\r\n"]}